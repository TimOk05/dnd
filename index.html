<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DM Copilot - AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤ D&D</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .medieval {
            font-family: 'MedievalSharp', cursive;
        }
        
        .modern {
            font-family: 'Inter', sans-serif;
        }
        
        .game-bg {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            background-attachment: fixed;
        }
        
        .card-game {
            background: linear-gradient(145deg, #2a2a3e 0%, #1e1e2e 100%);
            border: 2px solid #4a5568;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .btn-game {
            background: linear-gradient(145deg, #4a5568 0%, #2d3748 100%);
            border: 2px solid #718096;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        
        .btn-game:hover {
            background: linear-gradient(145deg, #718096 0%, #4a5568 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn-primary-game {
            background: linear-gradient(145deg, #d69e2e 0%, #b7791f 100%);
            border: 2px solid #f6ad55;
            color: #1a202c;
        }
        
        .btn-primary-game:hover {
            background: linear-gradient(145deg, #f6ad55 0%, #d69e2e 100%);
            transform: translateY(-2px);
        }
        
        .tab-game {
            background: rgba(45, 55, 72, 0.8);
            border: 1px solid #4a5568;
            backdrop-filter: blur(5px);
        }
        
        .tab-game.active {
            background: linear-gradient(145deg, #d69e2e 0%, #b7791f 100%);
            border-color: #f6ad55;
            color: #1a202c;
        }
        
        .loading-game {
            background: linear-gradient(90deg, #4a5568 25%, #718096 50%, #4a5568 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }
    </style>
</head>

<body class="game-bg min-h-screen text-gray-100">
    <div class="container mx-auto px-4 py-6 max-w-7xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="medieval text-6xl font-bold text-yellow-400 mb-4 drop-shadow-lg">
                ‚öîÔ∏è DM Copilot ‚öîÔ∏è
            </h1>
            <p class="modern text-xl text-gray-300 mb-4">
                AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤ D&D
            </p>
            <div class="inline-block p-3 bg-green-900/50 border border-green-500 rounded-lg">
                <span class="text-green-400 font-medium">ü§ñ AI –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –≤—Å–µ—Ö –∞–≤–∞–Ω—Ç—é—Ä–∏—Å—Ç–æ–≤</span>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="flex justify-center mb-8">
            <div class="flex space-x-2 bg-gray-800/50 rounded-lg p-2 backdrop-blur-sm">
                <button onclick="showTab('home')" class="tab-game active px-6 py-3 rounded-md text-lg modern">
                    üè∞ –ì–ª–∞–≤–Ω–∞—è
                </button>
                <button onclick="showTab('tables')" class="tab-game px-6 py-3 rounded-md text-lg modern">
                    üìú –¢–∞–±–ª–∏—Ü—ã
                </button>
                <button onclick="showTab('session')" class="tab-game px-6 py-3 rounded-md text-lg modern">
                    üé≠ –°–µ—Å—Å–∏—è
                </button>
                <button onclick="showTab('ai')" class="tab-game px-6 py-3 rounded-md text-lg modern">
                    üîÆ AI –ü–æ–¥—Å–∫–∞–∑–∫–∏
                </button>
                <button onclick="showTab('chat')" class="tab-game px-6 py-3 rounded-md text-lg modern">
                    üí¨ –ß–∞—Ç —Å AI
                </button>
            </div>
        </div>

        <!-- Home Tab -->
        <div id="home" class="tab-content">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="card-game p-6 text-center">
                    <div class="text-4xl mb-4">üìö</div>
                    <h3 class="text-xl font-semibold mb-3 modern">Knowledge Ingestion</h3>
                    <p class="text-base text-gray-300 modern">–ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥—É–ª–µ–π</p>
                </div>
                <div class="card-game p-6 text-center">
                    <div class="text-4xl mb-4">üìä</div>
                    <h3 class="text-xl font-semibold mb-3 modern">Tables Engine</h3>
                    <p class="text-base text-gray-300 modern">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</p>
                </div>
                <div class="card-game p-6 text-center">
                    <div class="text-4xl mb-4">üé≠</div>
                    <h3 class="text-xl font-semibold mb-3 modern">Session Runner</h3>
                    <p class="text-base text-gray-300 modern">–í–µ–¥–µ–Ω–∏–µ D&D —Å–µ—Å—Å–∏–π</p>
                </div>
                <div class="card-game p-6 text-center">
                    <div class="text-4xl mb-4">ü§ñ</div>
                    <h3 class="text-xl font-semibold mb-3 modern">AI Assistant</h3>
                    <p class="text-base text-gray-300 modern">–£–º–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –æ—Ç DeepSeek</p>
                </div>
            </div>

            <div class="card-game p-8 mb-8">
                <h2 class="medieval text-3xl font-bold mb-6 text-yellow-400">‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                    <button onclick="generateRandom('npc')" class="btn-game flex flex-col items-center p-6 h-32 rounded-lg">
                        <span class="text-4xl mb-3">üë§</span>
                        <span class="text-base modern">–°–ª—É—á–∞–π–Ω—ã–π NPC</span>
                    </button>
                    <button onclick="generateRandom('tavern')" class="btn-game flex flex-col items-center p-6 h-32 rounded-lg">
                        <span class="text-4xl mb-3">üè™</span>
                        <span class="text-base modern">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–≤–µ—Ä–Ω—ã</span>
                    </button>
                    <button onclick="generateRandom('potion')" class="btn-game flex flex-col items-center p-6 h-32 rounded-lg">
                        <span class="text-4xl mb-3">üß™</span>
                        <span class="text-base modern">–°–ª—É—á–∞–π–Ω–æ–µ –∑–µ–ª—å–µ</span>
                    </button>
                    <button onclick="rollDice()" class="btn-game flex flex-col items-center p-6 h-32 rounded-lg">
                        <span class="text-4xl mb-3">üé≤</span>
                        <span class="text-base modern">–ë—Ä–æ—Å–∏—Ç—å –∫–æ—Å—Ç–∏</span>
                    </button>
                </div>
            </div>

            <div class="card-game p-8">
                <h2 class="medieval text-3xl font-bold mb-6 text-yellow-400">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                    <div>
                        <div class="text-4xl font-bold text-yellow-400">5</div>
                        <div class="text-lg text-gray-300 modern">–¢–∞–±–ª–∏—Ü –¥–∞–Ω–Ω—ã—Ö</div>
                    </div>
                    <div>
                        <div class="text-4xl font-bold text-green-400">25</div>
                        <div class="text-lg text-gray-300 modern">–ó–∞–ø–∏—Å–µ–π</div>
                    </div>
                    <div>
                        <div class="text-4xl font-bold text-purple-400">0</div>
                        <div class="text-lg text-gray-300 modern">–°–µ—Å—Å–∏–π</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tables Tab -->
        <div id="tables" class="tab-content hidden">
            <div class="card-game p-8 mb-8">
                <h2 class="medieval text-3xl font-bold mb-8 text-yellow-400">üìú –¢–∞–±–ª–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="card-game p-6">
                        <h3 class="text-xl font-semibold mb-3 modern">üç∫ –ù–∞–ø–∏—Ç–∫–∏</h3>
                        <p class="text-base text-gray-300 mb-4 modern">–ê–ª–∫–æ–≥–æ–ª—å–Ω—ã–µ –∏ –±–µ–∑–∞–ª–∫–æ–≥–æ–ª—å–Ω—ã–µ –Ω–∞–ø–∏—Ç–∫–∏</p>
                        <div class="flex gap-3">
                            <button onclick="showTableData('drinks')" class="btn-primary-game px-4 py-2 rounded text-sm modern">–ü—Ä–æ—Å–º–æ—Ç—Ä</button>
                            <button onclick="generateRandom('drink')" class="btn-game px-4 py-2 rounded text-sm modern">–°–ª—É—á–∞–π–Ω—ã–π</button>
                        </div>
                    </div>
                    <div class="card-game p-6">
                        <h3 class="text-xl font-semibold mb-3 modern">üë§ NPC</h3>
                        <p class="text-base text-gray-300 mb-4 modern">–ù–µ–∏–≥—Ä–æ–≤—ã–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏</p>
                        <div class="flex gap-3">
                            <button onclick="showTableData('npcs')" class="btn-primary-game px-4 py-2 rounded text-sm modern">–ü—Ä–æ—Å–º–æ—Ç—Ä</button>
                            <button onclick="generateRandom('npc')" class="btn-game px-4 py-2 rounded text-sm modern">–°–ª—É—á–∞–π–Ω—ã–π</button>
                        </div>
                    </div>
                    <div class="card-game p-6">
                        <h3 class="text-xl font-semibold mb-3 modern">üß™ –ó–µ–ª—å—è</h3>
                        <p class="text-base text-gray-300 mb-4 modern">–ú–∞–≥–∏—á–µ—Å–∫–∏–µ –∑–µ–ª—å—è –∏ –∏—Ö —Å–≤–æ–π—Å—Ç–≤–∞</p>
                        <div class="flex gap-3">
                            <button onclick="showTableData('potions')" class="btn-primary-game px-4 py-2 rounded text-sm modern">–ü—Ä–æ—Å–º–æ—Ç—Ä</button>
                            <button onclick="generateRandom('potion')" class="btn-game px-4 py-2 rounded text-sm modern">–°–ª—É—á–∞–π–Ω—ã–π</button>
                        </div>
                    </div>
                    <div class="card-game p-6">
                        <h3 class="text-xl font-semibold mb-3 modern">üó°Ô∏è –°–æ–±—ã—Ç–∏—è –≤ –ø—É—Ç–∏</h3>
                        <p class="text-base text-gray-300 mb-4 modern">–°–ª—É—á–∞–π–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –≤–æ –≤—Ä–µ–º—è –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π</p>
                        <div class="flex gap-3">
                            <button onclick="showTableData('events')" class="btn-primary-game px-4 py-2 rounded text-sm modern">–ü—Ä–æ—Å–º–æ—Ç—Ä</button>
                            <button onclick="generateRandom('event')" class="btn-game px-4 py-2 rounded text-sm modern">–°–ª—É—á–∞–π–Ω—ã–π</button>
                        </div>
                    </div>
                    <div class="card-game p-6">
                        <h3 class="text-xl font-semibold mb-3 modern">üè™ –ù–∞–∑–≤–∞–Ω–∏—è —Ç–∞–≤–µ—Ä–Ω</h3>
                        <p class="text-base text-gray-300 mb-4 modern">–ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–ª—è —Ç–∞–≤–µ—Ä–Ω</p>
                        <div class="flex gap-3">
                            <button onclick="showTableData('taverns')" class="btn-primary-game px-4 py-2 rounded text-sm modern">–ü—Ä–æ—Å–º–æ—Ç—Ä</button>
                            <button onclick="generateRandom('tavern')" class="btn-game px-4 py-2 rounded text-sm modern">–°–ª—É—á–∞–π–Ω—ã–π</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tableData" class="card-game p-8 hidden">
                <h3 id="tableTitle" class="medieval text-2xl font-bold mb-6 text-yellow-400"></h3>
                <div id="tableContent" class="space-y-3"></div>
                <button onclick="hideTableData()" class="btn-game mt-6 px-6 py-3 rounded modern">‚Üê –ù–∞–∑–∞–¥ –∫ —Ç–∞–±–ª–∏—Ü–∞–º</button>
            </div>
        </div>

        <!-- Session Tab -->
        <div id="session" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Session Stages -->
                <div class="card-game p-6">
                    <h3 class="medieval text-xl font-semibold mb-6 text-yellow-400">üé≠ –≠—Ç–∞–ø —Å–µ—Å—Å–∏–∏</h3>
                    <div class="space-y-3">
                        <button onclick="setStage('hook')" class="stage-btn active w-full text-left p-4 rounded-lg card-game">
                            <div class="font-medium text-lg modern">üé£ –ó–∞—Ü–µ–ø–∫–∞</div>
                            <div class="text-base opacity-75 modern">–ù–∞—á–∞–ª–æ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è</div>
                        </button>
                        <button onclick="setStage('exploration')" class="stage-btn w-full text-left p-4 rounded-lg card-game">
                            <div class="font-medium text-lg modern">üó∫Ô∏è –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ</div>
                            <div class="text-base opacity-75 modern">–ò–∑—É—á–µ–Ω–∏–µ –º–∏—Ä–∞</div>
                        </button>
                        <button onclick="setStage('combat')" class="stage-btn w-full text-left p-4 rounded-lg card-game">
                            <div class="font-medium text-lg modern">‚öîÔ∏è –ë–æ–π</div>
                            <div class="text-base opacity-75 modern">–°—Ä–∞–∂–µ–Ω–∏—è –∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã</div>
                        </button>
                        <button onclick="setStage('social')" class="stage-btn w-full text-left p-4 rounded-lg card-game">
                            <div class="font-medium text-lg modern">ü§ù –°–æ—Ü–∏–∞–ª—å–Ω–æ–µ</div>
                            <div class="text-base opacity-75 modern">–î–∏–ø–ª–æ–º–∞—Ç–∏—è –∏ —Ç–æ—Ä–≥–æ–≤–ª—è</div>
                        </button>
                        <button onclick="setStage('puzzle')" class="stage-btn w-full text-left p-4 rounded-lg card-game">
                            <div class="font-medium text-lg modern">üß© –ì–æ–ª–æ–≤–æ–ª–æ–º–∫–∞</div>
                            <div class="text-base opacity-75 modern">–ó–∞–≥–∞–¥–∫–∏ –∏ –ª–æ–≤—É—à–∫–∏</div>
                        </button>
                        <button onclick="setStage('climax')" class="stage-btn w-full text-left p-4 rounded-lg card-game">
                            <div class="font-medium text-lg modern">üî• –ö—É–ª—å–º–∏–Ω–∞—Ü–∏—è</div>
                            <div class="text-base opacity-75 modern">–§–∏–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Ç–∏–≤–æ—Å—Ç–æ—è–Ω–∏–µ</div>
                        </button>
                        <button onclick="setStage('resolution')" class="stage-btn w-full text-left p-4 rounded-lg card-game">
                            <div class="font-medium text-lg modern">üèÅ –†–∞–∑–≤—è–∑–∫–∞</div>
                            <div class="text-base opacity-75 modern">–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è</div>
                        </button>
                    </div>
                </div>

                <!-- Master Notes -->
                <div class="card-game p-6">
                    <h3 class="medieval text-xl font-semibold mb-6 text-yellow-400">üìù –ó–∞–º–µ—Ç–∫–∏ –º–∞—Å—Ç–µ—Ä–∞</h3>
                    <textarea id="masterNotes" placeholder="–ó–∞–ø–∏—à–∏—Ç–µ –≤–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏, –ø–ª–∞–Ω—ã, –∏–¥–µ–∏..." class="w-full h-48 p-4 border border-gray-600 rounded-lg resize-none focus:ring-2 focus:ring-yellow-500 bg-gray-800 text-gray-100 modern"></textarea>
                    <div class="mt-4 text-base text-gray-300 modern">
                        –¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø: <span id="currentStage" class="font-medium text-yellow-400">üé£ –ó–∞—Ü–µ–ø–∫–∞</span>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card-game p-6">
                    <h3 class="medieval text-xl font-semibold mb-6 text-yellow-400">‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                    <div class="space-y-3">
                        <button onclick="rollDice()" class="btn-game w-full justify-start text-base modern">
                            üé≤ –ë—Ä–æ—Å–∏—Ç—å –∫–æ—Å—Ç–∏ (d20)
                        </button>
                        <button onclick="generateRandom('tavern')" class="btn-game w-full justify-start text-base modern">
                            üè™ –°–ª—É—á–∞–π–Ω–∞—è —Ç–∞–≤–µ—Ä–Ω–∞
                        </button>
                        <button onclick="generateRandom('potion')" class="btn-game w-full justify-start text-base modern">
                            üß™ –°–ª—É—á–∞–π–Ω–æ–µ –∑–µ–ª—å–µ
                        </button>
                        <button onclick="generateRandom('npc')" class="btn-game w-full justify-start text-base modern">
                            üó£Ô∏è –°–ª—É—á–∞–π–Ω—ã–π NPC
                        </button>
                        <button onclick="generateRandom('drink')" class="btn-game w-full justify-start text-base modern">
                            üç∫ –°–ª—É—á–∞–π–Ω—ã–π –Ω–∞–ø–∏—Ç–æ–∫
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Tab -->
        <div id="ai" class="tab-content hidden">
            <div class="card-game p-8 mb-8">
                <h2 class="medieval text-3xl font-bold mb-8 text-yellow-400">üîÆ AI –ü–æ–¥—Å–∫–∞–∑–∫–∏</h2>

                <!-- Context Input -->
                <div class="mb-6">
                    <label class="block text-lg font-medium mb-3 modern">–ö–æ–Ω—Ç–µ–∫—Å—Ç —Å–µ—Å—Å–∏–∏:</label>
                    <textarea id="sessionContext" placeholder="–û–ø–∏—à–∏—Ç–µ —Ç–µ–∫—É—â—É—é —Å–∏—Ç—É–∞—Ü–∏—é, –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π, –ª–æ–∫–∞—Ü–∏—é..." class="w-full h-24 p-4 border border-gray-600 rounded-lg resize-none focus:ring-2 focus:ring-yellow-500 bg-gray-800 text-gray-100 modern"></textarea>
                </div>

                <!-- AI Type Selection -->
                <div class="grid grid-cols-2 md:grid-cols-3 gap-6 mb-8">
                    <button onclick="setAIType('plot_twist')" class="ai-type-btn active p-6 border border-gray-600 rounded-lg text-center card-game">
                        <div class="text-4xl mb-3">üé≠</div>
                        <div class="font-medium text-lg modern">–ü–æ–≤–æ—Ä–æ—Ç —Å—é–∂–µ—Ç–∞</div>
                        <div class="text-base text-gray-400 modern">–ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –ø–æ–≤–æ—Ä–æ—Ç—ã</div>
                    </button>
                    <button onclick="setAIType('npc_dialogue')" class="ai-type-btn p-6 border border-gray-600 rounded-lg text-center card-game">
                        <div class="text-4xl mb-3">üó£Ô∏è</div>
                        <div class="font-medium text-lg modern">–î–∏–∞–ª–æ–≥ NPC</div>
                        <div class="text-base text-gray-400 modern">–ñ–∏–≤—ã–µ –¥–∏–∞–ª–æ–≥–∏</div>
                    </button>
                    <button onclick="setAIType('scene_description')" class="ai-type-btn p-6 border border-gray-600 rounded-lg text-center card-game">
                        <div class="text-4xl mb-3">üè∞</div>
                        <div class="font-medium text-lg modern">–û–ø–∏—Å–∞–Ω–∏–µ —Å—Ü–µ–Ω—ã</div>
                        <div class="text-base text-gray-400 modern">–ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è</div>
                    </button>
                    <button onclick="setAIType('loot_suggestion')" class="ai-type-btn p-6 border border-gray-600 rounded-lg text-center card-game">
                        <div class="text-4xl mb-3">üíé</div>
                        <div class="font-medium text-lg modern">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ª—É—Ç–∞</div>
                        <div class="text-base text-gray-400 modern">–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã</div>
                    </button>
                    <button onclick="setAIType('skill_check')" class="ai-type-btn p-6 border border-gray-600 rounded-lg text-center card-game">
                        <div class="text-4xl mb-3">üé≤</div>
                        <div class="font-medium text-lg modern">–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–≤—ã–∫–æ–≤</div>
                        <div class="text-base text-gray-400 modern">–õ–æ–≥–∏—á–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏</div>
                    </button>
                    <button onclick="setAIType('combat_encounter')" class="ai-type-btn p-6 border border-gray-600 rounded-lg text-center card-game">
                        <div class="text-4xl mb-3">‚öîÔ∏è</div>
                        <div class="font-medium text-lg modern">–ë–æ–µ–≤–∞—è –≤—Å—Ç—Ä–µ—á–∞</div>
                        <div class="text-base text-gray-400 modern">–¢–∞–∫—Ç–∏–∫–∞ –∏ –º–æ–Ω—Å—Ç—Ä—ã</div>
                    </button>
                </div>

                <!-- Generate Button -->
                <button onclick="generateAISuggestion()" id="generateBtn" class="btn-primary-game w-full text-lg py-4 rounded-lg modern">
                    üîÆ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é AI
                </button>
            </div>

            <!-- AI Result -->
            <div id="aiResult" class="card-game p-8 hidden">
                <h3 class="medieval text-xl font-semibold mb-6 text-yellow-400">–†–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ AI</h3>
                <div id="aiContent" class="bg-gray-800 p-6 rounded-lg mb-6 text-base modern border border-gray-600"></div>
                <div class="flex gap-4">
                    <button onclick="copyToClipboard()" class="btn-game px-6 py-3 rounded modern">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button onclick="regenerateAI()" class="btn-primary-game px-6 py-3 rounded modern">üîÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –µ—â–µ —Ä–∞–∑</button>
                </div>
            </div>

            <!-- Usage Stats -->
            <div class="card-game p-6 mt-8">
                <h3 class="medieval text-lg font-semibold mb-4 text-yellow-400">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                    <div>
                        <div class="text-2xl font-bold text-yellow-400" id="requestsCount">0</div>
                        <div class="text-sm text-gray-400 modern">–ó–∞–ø—Ä–æ—Å–æ–≤ –∫ AI</div>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-green-400" id="tokensUsed">0</div>
                        <div class="text-sm text-gray-400 modern">–¢–æ–∫–µ–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ</div>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-purple-400" id="avgResponseTime">0s</div>
                        <div class="text-sm text-gray-400 modern">–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Tab -->
        <div id="chat" class="tab-content hidden">
            <div class="card-game p-8 mb-8">
                <h2 class="medieval text-3xl font-bold mb-8 text-yellow-400">üí¨ –ß–∞—Ç —Å DeepSeek</h2>
                <p class="text-base text-gray-300 mb-6 modern">
                    –û–±—â–∞–π—Ç–µ—Å—å —Å AI-–ø–æ–º–æ—â–Ω–∏–∫–æ–º –º–∞—Å—Ç–µ—Ä–∞. –ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã –æ D&D, –ø—Ä–æ—Å–∏—Ç–µ —Å–æ–≤–µ—Ç—ã –ø–æ –≤–µ–¥–µ–Ω–∏—é –∏–≥—Ä—ã, –∏–¥–µ–∏ –¥–ª—è —Å—é–∂–µ—Ç–∞ –∏–ª–∏ –ø–æ–º–æ—â—å —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏.
                </p>

                <!-- Chat Interface -->
                <div class="bg-gray-800 border border-gray-600 rounded-lg h-96 mb-6">
                    <div id="chatContent" class="h-full p-4 overflow-y-auto space-y-4">
                        <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ -->
                        <div class="mb-4 text-left">
                            <div class="inline-block bg-gray-700 text-gray-100 p-3 rounded-lg max-w-xs lg:max-w-md">
                                <div class="text-sm">
                                    –ü—Ä–∏–≤–µ—Ç! –Ø DeepSeek, –≤–∞—à AI-–ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è D&D. –ú–æ–≥—É –ø–æ–º–æ—á—å —Å —Å–æ–≤–µ—Ç–∞–º–∏ –ø–æ –≤–µ–¥–µ–Ω–∏—é –∏–≥—Ä—ã, –∏–¥–µ—è–º–∏ –¥–ª—è —Å—é–∂–µ—Ç–∞, –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π –≤—Å—Ç—Ä–µ—á –∏ –º–Ω–æ–≥–∏–º –¥—Ä—É–≥–∏–º. –ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å!
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chat Input -->
                <div class="flex gap-4">
                    <input type="text" id="chatMessage" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ..." class="flex-1 p-3 border border-gray-600 rounded-lg bg-gray-800 text-gray-100 modern focus:ring-2 focus:ring-yellow-500 focus:border-transparent" onkeypress="handleChatKeyPress(event)">
                    <button id="sendChatBtn" onclick="sendChatMessage()" class="btn-primary-game px-6 py-3 rounded modern">
                        üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å
                    </button>
                </div>

                <!-- Chat Tips -->
                <div class="mt-6 p-4 bg-gray-800/50 border border-gray-600 rounded-lg">
                    <h4 class="text-lg font-semibold mb-3 text-yellow-400 modern">üí° –ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤:</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-gray-300">
                        <div>‚Ä¢ "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ NPC?"</div>
                        <div>‚Ä¢ "–ü–æ–º–æ–≥–∏ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –±–æ–µ–≤—É—é –≤—Å—Ç—Ä–µ—á—É"</div>
                        <div>‚Ä¢ "–ò–¥–µ–∏ –¥–ª—è –ø–æ–≤–æ—Ä–æ—Ç–∞ —Å—é–∂–µ—Ç–∞"</div>
                        <div>‚Ä¢ "–û–±—ä—è—Å–Ω–∏ –ø—Ä–∞–≤–∏–ª–æ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è"</div>
                        <div>‚Ä¢ "–ö–∞–∫ –æ–ø–∏—Å–∞—Ç—å –ª–æ–∫–∞—Ü–∏—é?"</div>
                        <div>‚Ä¢ "–°–æ–≤–µ—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö –º–∞—Å—Ç–µ—Ä–æ–≤"</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Modal -->
        <div id="resultModal" class="fixed inset-0 bg-black bg-opacity-75 hidden flex items-center justify-center z-50">
            <div class="card-game p-8 max-w-lg mx-4">
                <h3 class="medieval text-xl font-semibold mb-6 text-yellow-400">–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
                <div id="modalContent" class="mb-6 text-base modern"></div>
                <div class="flex gap-4">
                    <button onclick="copyToClipboard()" class="btn-primary-game flex-1 px-6 py-3 rounded modern">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button onclick="closeModal()" class="btn-game flex-1 px-6 py-3 rounded modern">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API
        const API_BASE_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' ?
            '' // –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
            :
            'https://your-netlify-app.netlify.app'; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à Netlify URL

        // Demo data
        const demoData = {
            drinks: [{
                name: "–≠–ª—å—Ñ–æ–≤—Å–∫–æ–µ –≤–∏–Ω–æ",
                effect: "–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç 1d4 HP",
                price: "5 –∑–æ–ª–æ—Ç—ã—Ö"
            }, {
                name: "–û–≥–Ω–µ–Ω–Ω—ã–π —ç–ª—å",
                effect: "–î–∞–µ—Ç —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ –æ–≥–Ω—é –Ω–∞ 1 —á–∞—Å",
                price: "3 –∑–æ–ª–æ—Ç—ã—Ö"
            }, {
                name: "–õ—É–Ω–Ω—ã–π –Ω–µ–∫—Ç–∞—Ä",
                effect: "–£–ª—É—á—à–∞–µ—Ç –∑—Ä–µ–Ω–∏–µ –≤ —Ç–µ–º–Ω–æ—Ç–µ",
                price: "8 –∑–æ–ª–æ—Ç—ã—Ö"
            }, {
                name: "–ì–Ω–æ–º—Å–∫–∏–π —ç–ª—å",
                effect: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å–∏–ª—É –Ω–∞ +2 –Ω–∞ 10 –º–∏–Ω—É—Ç",
                price: "4 –∑–æ–ª–æ—Ç—ã—Ö"
            }, {
                name: "–î—Ä–∞–∫–æ–Ω—å–µ –ø–∏–≤–æ",
                effect: "–î—ã—Ö–∞–Ω–∏–µ –æ–≥–Ω–µ–º 1 —Ä–∞–∑",
                price: "15 –∑–æ–ª–æ—Ç—ã—Ö"
            }],
            npcs: [{
                name: "–¢–æ—Ä–∏–Ω –ñ–µ–ª–µ–∑–Ω–æ–±–æ—Ä–æ–¥",
                race: "–î–≤–∞—Ä—Ñ",
                profession: "–ö—É–∑–Ω–µ—Ü",
                personality: "–£–ø—Ä—è–º—ã–π, –Ω–æ —á–µ—Å—Ç–Ω—ã–π"
            }, {
                name: "–≠–ª–∞—Ä–∞ –°–≤–µ—Ç–ª–∞—è",
                race: "–≠–ª—å—Ñ",
                profession: "–ú–∞–≥",
                personality: "–ú—É–¥—Ä–∞—è –∏ –∑–∞–≥–∞–¥–æ—á–Ω–∞—è"
            }, {
                name: "–ì—Ä–æ–≥ –°–∏–ª–∞—á",
                race: "–ü–æ–ª—É–æ—Ä–∫",
                profession: "–û—Ö—Ä–∞–Ω–Ω–∏–∫",
                personality: "–ì—Ä—É–±—ã–π, –Ω–æ –≤–µ—Ä–Ω—ã–π"
            }, {
                name: "–ó–∞—Ä–∞ –¢–µ–Ω—å",
                race: "–ü–æ–ª—É—ç–ª—å—Ñ",
                profession: "–í–æ—Ä",
                personality: "–•–∏—Ç—Ä—ã–π –∏ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã–π"
            }, {
                name: "–ú–∞—Ä–∫—É—Å –î–æ–±—Ä–æ—Å–µ—Ä–¥",
                race: "–ß–µ–ª–æ–≤–µ–∫",
                profession: "–¢–æ—Ä–≥–æ–≤–µ—Ü",
                personality: "–î—Ä—É–∂–µ–ª—é–±–Ω—ã–π –∏ —â–µ–¥—Ä—ã–π"
            }],
            potions: [{
                name: "–ó–µ–ª—å–µ –ª–µ—á–µ–Ω–∏—è",
                effect: "–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç 2d4+2 HP",
                rarity: "–û–±—ã—á–Ω–æ–µ"
            }, {
                name: "–ó–µ–ª—å–µ –Ω–µ–≤–∏–¥–∏–º–æ—Å—Ç–∏",
                effect: "–ù–µ–≤–∏–¥–∏–º–æ—Å—Ç—å –Ω–∞ 1 —á–∞—Å",
                rarity: "–†–µ–¥–∫–æ–µ"
            }, {
                name: "–ó–µ–ª—å–µ –ø–æ–ª–µ—Ç–∞",
                effect: "–ü–æ–ª–µ—Ç –Ω–∞ 10 –º–∏–Ω—É—Ç",
                rarity: "–†–µ–¥–∫–æ–µ"
            }, {
                name: "–ó–µ–ª—å–µ –≥–∏–≥–∞–Ω—Ç—Å–∫–æ–π —Å–∏–ª—ã",
                effect: "–°–∏–ª–∞ +4 –Ω–∞ 1 —á–∞—Å",
                rarity: "–ù–µ–æ–±—ã—á–Ω–æ–µ"
            }, {
                name: "–ó–µ–ª—å–µ –∏—Å—Ç–∏–Ω–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è",
                effect: "–í–∏–¥–∏—Ç —Å–∫—Ä—ã—Ç–æ–µ –Ω–∞ 1 —á–∞—Å",
                rarity: "–û—á–µ–Ω—å —Ä–µ–¥–∫–æ–µ"
            }],
            events: [{
                name: "–í—Å—Ç—Ä–µ—á–∞ —Å —Ç–æ—Ä–≥–æ–≤—Ü–µ–º",
                description: "–û–¥–∏–Ω–æ–∫–∏–π —Ç–æ—Ä–≥–æ–≤–µ—Ü –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–µ–¥–∫–∏–µ —Ç–æ–≤–∞—Ä—ã",
                difficulty: "–õ–µ–≥–∫–æ–µ"
            }, {
                name: "–ù–∞–ø–∞–¥–µ–Ω–∏–µ –±–∞–Ω–¥–∏—Ç–æ–≤",
                description: "–ì—Ä—É–ø–ø–∞ —Ä–∞–∑–±–æ–π–Ω–∏–∫–æ–≤ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Ä–æ–≥—É",
                difficulty: "–°—Ä–µ–¥–Ω–µ–µ"
            }, {
                name: "–ó–∞–±–ª—É–¥–∏–≤—à–∏–π—Å—è –ø—É—Ç–Ω–∏–∫",
                description: "–ü—É—Ç–Ω–∏–∫ –ø—Ä–æ—Å–∏—Ç –ø–æ–º–æ—â–∏ –Ω–∞–π—Ç–∏ –¥–æ—Ä–æ–≥—É",
                difficulty: "–õ–µ–≥–∫–æ–µ"
            }, {
                name: "–î—Ä–µ–≤–Ω–∏–µ —Ä—É–∏–Ω—ã",
                description: "–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—Å—Ç–∞—Ç–∫–∏ –¥—Ä–µ–≤–Ω–µ–≥–æ —Å–æ–æ—Ä—É–∂–µ–Ω–∏—è",
                difficulty: "–°–ª–æ–∂–Ω–æ–µ"
            }, {
                name: "–ú–∞–≥–∏—á–µ—Å–∫–∞—è –±—É—Ä—è",
                description: "–°—Ç—Ä–∞–Ω–Ω—ã–µ –ø–æ–≥–æ–¥–Ω—ã–µ —è–≤–ª–µ–Ω–∏—è",
                difficulty: "–û—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ–µ"
            }],
            taverns: [{
                name: "–ü—å—è–Ω—ã–π –¥—Ä–∞–∫–æ–Ω",
                description: "–®—É–º–Ω–∞—è —Ç–∞–≤–µ—Ä–Ω–∞ –¥–ª—è –∞–≤–∞–Ω—Ç—é—Ä–∏—Å—Ç–æ–≤",
                atmosphere: "–ë–æ–π–∫–∞—è"
            }, {
                name: "–¢–∏—Ö–∞—è –≥–∞–≤–∞–Ω—å",
                description: "–°–ø–æ–∫–æ–π–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –æ—Ç–¥—ã—Ö–∞",
                atmosphere: "–£—é—Ç–Ω–∞—è"
            }, {
                name: "–ö—É–∑–Ω–∏—Ü–∞ –∏ –∫—Ä—É–∂–∫–∞",
                description: "–¢–∞–≤–µ—Ä–Ω–∞ —Ä—è–¥–æ–º —Å –∫—É–∑–Ω–∏—Ü–µ–π",
                atmosphere: "–†–∞–±–æ—á–∞—è"
            }, {
                name: "–õ—É–Ω–Ω—ã–π —Å–≤–µ—Ç",
                description: "–≠–ª–µ–≥–∞–Ω—Ç–Ω–∞—è —Ç–∞–≤–µ—Ä–Ω–∞ –¥–ª—è –∑–Ω–∞—Ç–∏",
                atmosphere: "–ê—Ä–∏—Å—Ç–æ–∫—Ä–∞—Ç–∏—á–Ω–∞—è"
            }, {
                name: "–ü–æ–¥–∑–µ–º–µ–ª—å–µ",
                description: "–¢–∞–≤–µ—Ä–Ω–∞ –≤ –ø–æ–¥–≤–∞–ª–µ —Å—Ç–∞—Ä–æ–≥–æ –∑–¥–∞–Ω–∏—è",
                atmosphere: "–ú—Ä–∞—á–Ω–∞—è"
            }]
        };

        let currentAIType = 'plot_twist';
        let requestCount = 0;
        let totalTokens = 0;
        let responseTimes = [];

        // Tab management
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            document.getElementById(tabName).classList.remove('hidden');

            document.querySelectorAll('.tab-game').forEach(btn => btn.classList.remove('active', 'bg-yellow-500', 'text-gray-900'));
            event.target.classList.add('active', 'bg-yellow-500', 'text-gray-900');
        }

        // Stage management
        function setStage(stage) {
            document.querySelectorAll('.stage-btn').forEach(btn => btn.classList.remove('active', 'bg-yellow-500', 'text-gray-900'));
            event.target.classList.add('active', 'bg-yellow-500', 'text-gray-900');

            const stageNames = {
                hook: 'üé£ –ó–∞—Ü–µ–ø–∫–∞',
                exploration: 'üó∫Ô∏è –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ',
                combat: '‚öîÔ∏è –ë–æ–π',
                social: 'ü§ù –°–æ—Ü–∏–∞–ª—å–Ω–æ–µ',
                puzzle: 'üß© –ì–æ–ª–æ–≤–æ–ª–æ–º–∫–∞',
                climax: 'üî• –ö—É–ª—å–º–∏–Ω–∞—Ü–∏—è',
                resolution: 'üèÅ –†–∞–∑–≤—è–∑–∫–∞'
            };
            document.getElementById('currentStage').textContent = stageNames[stage];
        }

        // AI type management
        function setAIType(type) {
            currentAIType = type;
            document.querySelectorAll('.ai-type-btn').forEach(btn => btn.classList.remove('active', 'bg-yellow-500', 'text-gray-900'));
            event.target.classList.add('active', 'bg-yellow-500', 'text-gray-900');
        }

        // Random generation with better randomization
        function generateRandom(type) {
            let data, title, content;

            const seed = Date.now() + Math.random();
            const randomIndex = Math.floor((seed % 1000) % demoData[type].length);

            switch (type) {
                case 'npc':
                    data = demoData.npcs[randomIndex];
                    title = 'üë§ –°–ª—É—á–∞–π–Ω—ã–π NPC';
                    content = `
                        <strong>–ò–º—è:</strong> ${data.name}<br>
                        <strong>–†–∞—Å–∞:</strong> ${data.race}<br>
                        <strong>–ü—Ä–æ—Ñ–µ—Å—Å–∏—è:</strong> ${data.profession}<br>
                        <strong>–•–∞—Ä–∞–∫—Ç–µ—Ä:</strong> ${data.personality}
                    `;
                    break;
                case 'tavern':
                    data = demoData.taverns[randomIndex];
                    title = 'üè™ –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–≤–µ—Ä–Ω—ã';
                    content = `
                        <strong>–ù–∞–∑–≤–∞–Ω–∏–µ:</strong> ${data.name}<br>
                        <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${data.description}<br>
                        <strong>–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞:</strong> ${data.atmosphere}
                    `;
                    break;
                case 'potion':
                    data = demoData.potions[randomIndex];
                    title = 'üß™ –°–ª—É—á–∞–π–Ω–æ–µ –∑–µ–ª—å–µ';
                    content = `
                        <strong>–ù–∞–∑–≤–∞–Ω–∏–µ:</strong> ${data.name}<br>
                        <strong>–≠—Ñ—Ñ–µ–∫—Ç:</strong> ${data.effect}<br>
                        <strong>–†–µ–¥–∫–æ—Å—Ç—å:</strong> ${data.rarity}
                    `;
                    break;
                case 'drink':
                    data = demoData.drinks[randomIndex];
                    title = 'üç∫ –°–ª—É—á–∞–π–Ω—ã–π –Ω–∞–ø–∏—Ç–æ–∫';
                    content = `
                        <strong>–ù–∞–∑–≤–∞–Ω–∏–µ:</strong> ${data.name}<br>
                        <strong>–≠—Ñ—Ñ–µ–∫—Ç:</strong> ${data.effect}<br>
                        <strong>–¶–µ–Ω–∞:</strong> ${data.price}
                    `;
                    break;
                case 'event':
                    data = demoData.events[randomIndex];
                    title = 'üó°Ô∏è –°–ª—É—á–∞–π–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ';
                    content = `
                        <strong>–°–æ–±—ã—Ç–∏–µ:</strong> ${data.name}<br>
                        <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${data.description}<br>
                        <strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å:</strong> ${data.difficulty}
                    `;
                    break;
            }

            showModal(title, content);
        }

        // Show table data
        function showTableData(table) {
            const tableNames = {
                drinks: 'üç∫ –ù–∞–ø–∏—Ç–∫–∏',
                npcs: 'üë§ NPC',
                potions: 'üß™ –ó–µ–ª—å—è',
                events: 'üó°Ô∏è –°–æ–±—ã—Ç–∏—è –≤ –ø—É—Ç–∏',
                taverns: 'üè™ –ù–∞–∑–≤–∞–Ω–∏—è —Ç–∞–≤–µ—Ä–Ω'
            };

            document.getElementById('tableTitle').textContent = tableNames[table];
            const content = document.getElementById('tableContent');
            content.innerHTML = '';

            demoData[table].forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'card-game p-4 text-base modern';
                div.innerHTML = `<strong>${index + 1}.</strong> ${Object.values(item).join(' | ')}`;
                content.appendChild(div);
            });

            document.getElementById('tableData').classList.remove('hidden');
        }

        function hideTableData() {
            document.getElementById('tableData').classList.add('hidden');
        }

        // Dice rolling
        function rollDice() {
            const result = Math.floor(Math.random() * 20) + 1;
            showModal('üé≤ –ë—Ä–æ—Å–æ–∫ –∫–æ—Å—Ç–µ–π', `–í—ã–ø–∞–ª–æ: <strong>${result}</strong>`);
        }

        // Generate AI suggestion (with backend proxy)
        async function generateAISuggestion() {
            const context = document.getElementById('sessionContext').value;
            const generateBtn = document.getElementById('generateBtn');
            const aiContent = document.getElementById('aiContent');

            generateBtn.disabled = true;
            generateBtn.innerHTML = 'üîÑ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º...';
            aiContent.innerHTML = '<div class="loading-game h-8 rounded"></div>';
            document.getElementById('aiResult').classList.remove('hidden');

            const startTime = Date.now();

            try {
                const response = await fetch(`${API_BASE_URL}/api/orchestrate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        templateType: currentAIType,
                        context: {
                            sessionStage: 'general',
                            masterNotes: context,
                            moduleSummary: '',
                            recentEvents: [],
                            relevantChunks: [],
                            tableData: []
                        }
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    const endTime = Date.now();
                    const responseTime = (endTime - startTime) / 1000;

                    aiContent.innerHTML = data.suggestion.replace(/\n/g, '<br>');
                    updateStats(data.tokens || 0, responseTime);
                } else {
                    generateDemoSuggestion();
                }

            } catch (error) {
                generateDemoSuggestion();
            }

            generateBtn.disabled = false;
            generateBtn.innerHTML = 'üîÆ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é AI';
        }

        // Chat with DeepSeek
        async function sendChatMessage() {
            const messageInput = document.getElementById('chatMessage');
            const message = messageInput.value.trim();

            if (!message) return;

            const chatContent = document.getElementById('chatContent');
            const sendBtn = document.getElementById('sendChatBtn');
            const context = document.getElementById('sessionContext').value;

            // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const userMessageDiv = document.createElement('div');
            userMessageDiv.className = 'mb-4 text-right';
            userMessageDiv.innerHTML = `
                <div class="inline-block bg-blue-600 text-white p-3 rounded-lg max-w-xs lg:max-w-md">
                    <div class="text-sm">${message}</div>
                </div>
            `;
            chatContent.appendChild(userMessageDiv);

            // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
            messageInput.value = '';

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'mb-4 text-left';
            loadingDiv.innerHTML = `
                <div class="inline-block bg-gray-700 text-gray-300 p-3 rounded-lg">
                    <div class="flex items-center">
                        <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></div>
                        <span>DeepSeek –¥—É–º–∞–µ—Ç...</span>
                    </div>
                </div>
            `;
            chatContent.appendChild(loadingDiv);

            // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É
            sendBtn.disabled = true;

            try {
                const response = await fetch(`${API_BASE_URL}/api/orchestrate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: message,
                        context: context,
                        isChat: true
                    })
                });

                // –£–¥–∞–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                chatContent.removeChild(loadingDiv);

                if (response.ok) {
                    const data = await response.json();

                    // –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç AI
                    const aiMessageDiv = document.createElement('div');
                    aiMessageDiv.className = 'mb-4 text-left';
                    aiMessageDiv.innerHTML = `
                        <div class="inline-block bg-gray-700 text-gray-100 p-3 rounded-lg max-w-xs lg:max-w-md">
                            <div class="text-sm">${data.suggestion.replace(/\n/g, '<br>')}</div>
                        </div>
                    `;
                    chatContent.appendChild(aiMessageDiv);
                } else {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'mb-4 text-left';
                    errorDiv.innerHTML = `
                        <div class="inline-block bg-red-600 text-white p-3 rounded-lg">
                            <div class="text-sm">–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç AI</div>
                        </div>
                    `;
                    chatContent.appendChild(errorDiv);
                }

            } catch (error) {
                // –£–¥–∞–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                chatContent.removeChild(loadingDiv);

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
                const errorDiv = document.createElement('div');
                errorDiv.className = 'mb-4 text-left';
                errorDiv.innerHTML = `
                    <div class="inline-block bg-red-600 text-white p-3 rounded-lg">
                        <div class="text-sm">–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É</div>
                    </div>
                `;
                chatContent.appendChild(errorDiv);
            }

            // –í–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –æ–±—Ä–∞—Ç–Ω–æ
            sendBtn.disabled = false;

            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
            chatContent.scrollTop = chatContent.scrollHeight;
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ Enter –≤ —á–∞—Ç–µ
        function handleChatKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendChatMessage();
            }
        }

        // Fallback demo suggestion generation
        function generateDemoSuggestion() {
            const suggestions = {
                plot_twist: [
                    "–í–Ω–µ–∑–∞–ø–Ω–æ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ –≥–ª–∞–≤–Ω—ã–π –∞–Ω—Ç–∞–≥–æ–Ω–∏—Å—Ç - —ç—Ç–æ –¥–∞–≤–Ω–æ –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–π –±—Ä–∞—Ç –æ–¥–Ω–æ–≥–æ –∏–∑ –∏–≥—Ä–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –ø—Ä–æ–∫–ª—è—Ç –∏ –ø—Ä–µ–≤—Ä–∞—â–µ–Ω –≤ –º–æ–Ω—Å—Ç—Ä–∞.",
                    "–î—Ä–µ–≤–Ω–∏–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –∏—â—É—Ç –≥–µ—Ä–æ–∏, –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–æ–º –∫ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—é —Å–ø—è—â–µ–≥–æ –±–æ–≥–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å –º–∏—Ä.",
                    "–û–¥–∏–Ω –∏–∑ NPC, –∫–æ—Ç–æ—Ä–æ–º—É –¥–æ–≤–µ—Ä—è—é—Ç –∏–≥—Ä–æ–∫–∏, –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —à–ø–∏–æ–Ω–æ–º –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞, —Å–æ–±–∏—Ä–∞—é—â–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥—Ä—É–ø–ø–µ."
                ],
                npc_dialogue: [
                    "\"–Ø –≤–∏–¥–µ–ª, –∫–∞–∫ —Ç–≤–æ–∏ –≥–ª–∞–∑–∞ —Å–≤–µ—Ç—è—Ç—Å—è –≤ —Ç–µ–º–Ω–æ—Ç–µ... –¢—ã –Ω–µ —Å–æ–≤—Å–µ–º —á–µ–ª–æ–≤–µ–∫, –Ω–µ —Ç–∞–∫ –ª–∏?\" - –≥–æ–≤–æ—Ä–∏—Ç —Å—Ç–∞—Ä—ã–π –º—É–¥—Ä–µ—Ü, –ø—Ä–∏—Å—Ç–∞–ª—å–Ω–æ –≥–ª—è–¥—è –Ω–∞ –∏–≥—Ä–æ–∫–∞.",
                    "\"–í —ç—Ç–∏—Ö –∑–µ–º–ª—è—Ö –∫–∞–∂–¥—ã–π –∫–∞–º–µ–Ω—å –ø–æ–º–Ω–∏—Ç –¥—Ä–µ–≤–Ω–∏–µ –≤–æ–π–Ω—ã. –ë—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã, –∏–±–æ –ø—Ä–æ—à–ª–æ–µ –∏–º–µ–µ—Ç –ø—Ä–∏–≤—ã—á–∫—É –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è.\"",
                    "\"–ú–æ–π –æ—Ç–µ—Ü –≥–æ–≤–æ—Ä–∏–ª, —á—Ç–æ –Ω–∞—Å—Ç–æ—è—â–∞—è —Å–∏–ª–∞ –Ω–µ –≤ –º–µ—á–µ, –∞ –≤ —Ç–æ–º, –∫–∞–∫ —Ç—ã –µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å. –ù–æ –∏–Ω–æ–≥–¥–∞... –∏–Ω–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –ø—Ä–æ—Å—Ç–æ –æ—á–µ–Ω—å –æ—Å—Ç—Ä—ã–π –º–µ—á.\""
                ],
                scene_description: [
                    "–õ—É–Ω–Ω—ã–π —Å–≤–µ—Ç –ø—Ä–æ–±–∏–≤–∞–µ—Ç—Å—è —Å–∫–≤–æ–∑—å –≥—É—Å—Ç—ã–µ –æ–±–ª–∞–∫–∞, —Å–æ–∑–¥–∞–≤–∞—è –ø—Ä–∏–∑—Ä–∞—á–Ω—ã–µ —Ç–µ–Ω–∏ –Ω–∞ –¥—Ä–µ–≤–Ω–∏—Ö —Å—Ç–µ–Ω–∞—Ö –∑–∞–º–∫–∞. –í–æ–∑–¥—É—Ö –Ω–∞–ø–æ–ª–Ω–µ–Ω –∑–∞–ø–∞—Ö–æ–º –≤–ª–∞–∂–Ω–æ–π –∑–µ–º–ª–∏ –∏ —á–µ–≥–æ-—Ç–æ –±–æ–ª–µ–µ –¥—Ä–µ–≤–Ω–µ–≥–æ, –±–æ–ª–µ–µ —Ç–µ–º–Ω–æ–≥–æ. –í–¥–∞–ª–µ–∫–µ —Å–ª—ã—à–∏—Ç—Å—è –≤–æ–π –≤–æ–ª–∫–∞, –∞ –≤–µ—Ç–µ—Ä —à–µ–ø—á–µ—Ç –∑–∞–±—ã—Ç—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –º–µ–∂–¥—É –∫–æ–ª–æ–Ω–Ω–∞–º–∏.",
                    "–¢–∞–≤–µ—Ä–Ω–∞ –≥—É–¥–∏—Ç –æ—Ç –≥–æ–ª–æ—Å–æ–≤ –∏ —Å–º–µ—Ö–∞. –î—ã–º –æ—Ç —Ç—Ä—É–± —Å–æ–∑–¥–∞–µ—Ç –º–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É, –∞ —Å–≤–µ—Ç —Ñ–∞–∫–µ–ª–æ–≤ —Ç–∞–Ω—Ü—É–µ—Ç –Ω–∞ —Å—Ç–µ–Ω–∞—Ö, —É–∫—Ä–∞—à–µ–Ω–Ω—ã—Ö —Ç—Ä–æ—Ñ–µ—è–º–∏ –∏ —Å—Ç–∞—Ä—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏. –ó–∞ –æ–¥–Ω–∏–º –∏–∑ —Å—Ç–æ–ª–æ–≤ –≥—Ä—É–ø–ø–∞ –∞–≤–∞–Ω—Ç—é—Ä–∏—Å—Ç–æ–≤ –≥–æ—Ä—è—á–æ –æ–±—Å—É–∂–¥–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–ª—É—Ö–∏ –æ —Å–æ–∫—Ä–æ–≤–∏—â–∞—Ö.",
                    "–î—Ä–µ–≤–Ω–∏–π –ª–µ—Å –æ–∫—Ä—É–∂–∞–µ—Ç –≤–∞—Å —Å–æ –≤—Å–µ—Ö —Å—Ç–æ—Ä–æ–Ω, –µ–≥–æ –≤–µ—Ç–≤–∏ —Å–ø–ª–µ—Ç–∞—é—Ç—Å—è –Ω–∞–¥ –≥–æ–ª–æ–≤–æ–π, —Å–æ–∑–¥–∞–≤–∞—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–≤–æ–¥. –í–æ–∑–¥—É—Ö –Ω–∞–ø–æ–ª–Ω–µ–Ω –∞—Ä–æ–º–∞—Ç–æ–º —Ö–≤–æ–∏ –∏ —Ü–≤–µ—Ç–æ–≤, –∞ –≤–¥–∞–ª–µ–∫–µ —Å–ª—ã—à–∏—Ç—Å—è –∂—É—Ä—á–∞–Ω–∏–µ —Ä—É—á—å—è. –ó–¥–µ—Å—å —á—É–≤—Å—Ç–≤—É–µ—Ç—Å—è –¥—Ä–µ–≤–Ω—è—è –º–∞–≥–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–Ω–∏–∑—ã–≤–∞–µ—Ç –∫–∞–∂–¥–æ–µ –¥–µ—Ä–µ–≤–æ –∏ –∫–∞–∂–¥—ã–π –∫–∞–º–µ–Ω—å."
                ],
                loot_suggestion: [
                    "–í —Å—É–Ω–¥—É–∫–µ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ: –º–∞–≥–∏—á–µ—Å–∫–∏–π –∫–∏–Ω–∂–∞–ª +1, 50 –∑–æ–ª–æ—Ç—ã—Ö –º–æ–Ω–µ—Ç, —Å–≤–∏—Ç–æ–∫ —Å –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ–º '–û–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä', –∏ —Å—Ç—Ä–∞–Ω–Ω—ã–π –∞–º—É–ª–µ—Ç —Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ —Ä—É–Ω–∞–º–∏.",
                    "–ü–æ—Å–ª–µ –ø–æ–±–µ–¥—ã –Ω–∞–¥ –±–æ—Å—Å–æ–º –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ: –∫–æ–ª—å—Ü–æ –∑–∞—â–∏—Ç—ã +1, –∑–µ–ª—å–µ –ª–µ—á–µ–Ω–∏—è, –¥—Ä–µ–≤–Ω—é—é –∫–∞—Ä—Ç—É —Å–æ–∫—Ä–æ–≤–∏—â, –∏ –∫–ª—é—á –æ—Ç –ø–æ—Ç–∞–π–Ω–æ–π –¥–≤–µ—Ä–∏ –≤ –ø–æ–¥–∑–µ–º–µ–ª—å–µ.",
                    "–ò—Å—Å–ª–µ–¥—É—è —Ä—É–∏–Ω—ã, –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ: —ç–ª—å—Ñ–∏–π—Å–∫–∏–π –ª—É–∫ +2, –º–µ—à–æ–∫ —Å –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã–º–∏ –∫–∞–º–Ω—è–º–∏ (100 –∑–æ–ª–æ—Ç—ã—Ö), —Å–≤–∏—Ç–æ–∫ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏, –∏ –¥–Ω–µ–≤–Ω–∏–∫ —Å –≤–∞–∂–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π."
                ],
                skill_check: [
                    "–ü—Ä–æ–≤–µ—Ä–∫–∞ –õ–æ–≤–∫–æ—Å—Ç–∏ (DC 15): –ü—Ä—ã–∂–æ–∫ —á–µ—Ä–µ–∑ –ø—Ä–æ–ø–∞—Å—Ç—å —Ç—Ä–µ–±—É–µ—Ç —Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ –∏ –≥—Ä–∞—Ü–∏–∏. –ü—Ä–∏ —É—Å–ø–µ—Ö–µ - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø—Ä–∏–∑–µ–º–ª–µ–Ω–∏–µ, –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ - –ø–∞–¥–µ–Ω–∏–µ –∏ —É—Ä–æ–Ω.",
                    "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ú—É–¥—Ä–æ—Å—Ç–∏ (DC 12): –ó–∞–º–µ—Ç–∏—Ç—å —Å–∫—Ä—ã—Ç—ã–µ —Å–ª–µ–¥—ã –Ω–∞ –∑–µ–º–ª–µ, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ç–∞–π–Ω–æ–º—É —É–±–µ–∂–∏—â—É –±–∞–Ω–¥–∏—Ç–æ–≤ –∏–ª–∏ –∫ —Å–æ–∫—Ä–æ–≤–∏—â–∞–º.",
                    "–ü—Ä–æ–≤–µ—Ä–∫–∞ –•–∞—Ä–∏–∑–º—ã (DC 14): –£–±–µ–¥–∏—Ç—å –º–µ—Å—Ç–Ω—ã—Ö –∂–∏—Ç–µ–ª–µ–π –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å—Ç—Ä–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö –≤ –¥–µ—Ä–µ–≤–Ω–µ, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã —Å –≤–∞—à–∏–º –∫–≤–µ—Å—Ç–æ–º."
                ],
                combat_encounter: [
                    "–ë–æ–µ–≤–∞—è –≤—Å—Ç—Ä–µ—á–∞: –ì—Ä—É–ø–ø–∞ –≥–æ–±–ª–∏–Ω–æ–≤ (4 —à—Ç.) –∑–∞—Å–∞–¥–∏–ª–∞ –¥–æ—Ä–æ–≥—É. –û–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–∞–∫—Ç–∏–∫—É –∑–∞—Å–∞–¥—ã –∏ —Å—Ç—Ä–µ–ª—è—é—Ç –∏–∑ –ª—É–∫–æ–≤ –∏–∑ —É–∫—Ä—ã—Ç–∏–π. –û–∫—Ä—É–∂–µ–Ω–∏–µ: –≥—É—Å—Ç–æ–π –ª–µ—Å, —É–∑–∫–∞—è —Ç—Ä–æ–ø–∞, –≤–∞–ª—É–Ω—ã –¥–ª—è —É–∫—Ä—ã—Ç–∏—è.",
                    "–ë–æ–µ–≤–∞—è –≤—Å—Ç—Ä–µ—á–∞: –î–≤–∞ –æ–≥—Ä–∞-–±–µ—Ä—Å–µ—Ä–∫–∞ –∞—Ç–∞–∫—É—é—Ç –∏–∑ –∑–∞—Å–∞–¥—ã. –û–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —è—Ä–æ—Å—Ç—å –∏ –∞—Ç–∞–∫—É—é—Ç –±–ª–∏–∂–∞–π—à–∏—Ö –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–æ–≤. –û–∫—Ä—É–∂–µ–Ω–∏–µ: –∫–∞–º–µ–Ω–∏—Å—Ç–∞—è –º–µ—Å—Ç–Ω–æ—Å—Ç—å, –ø–µ—â–µ—Ä–∞ –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏.",
                    "–ë–æ–µ–≤–∞—è –≤—Å—Ç—Ä–µ—á–∞: –°—Ç–∞—è –≤–æ–ª–∫–æ–≤ (6 —à—Ç.) –æ–∫—Ä—É–∂–∞–µ—Ç –≥—Ä—É–ø–ø—É. –û–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–∞–∫—Ç–∏–∫—É —Å—Ç–∞–∏ –∏ –ø—ã—Ç–∞—é—Ç—Å—è –æ—Ç—Ä–µ–∑–∞—Ç—å –æ—Ç—Å—Ç—É–ø–ª–µ–Ω–∏–µ. –û–∫—Ä—É–∂–µ–Ω–∏–µ: –æ—Ç–∫—Ä—ã—Ç–∞—è —Ä–∞–≤–Ω–∏–Ω–∞, –Ω–æ—á—å, –ø–æ–ª–Ω–∞—è –ª—É–Ω–∞."
                ]
            };

            const seed = Date.now() + Math.random();
            const randomIndex = Math.floor((seed % 1000) % suggestions[currentAIType].length);
            const suggestion = suggestions[currentAIType][randomIndex];

            document.getElementById('aiContent').innerHTML = suggestion;
            updateStats(50, 0.5);
        }

        // Regenerate AI response
        function regenerateAI() {
            generateAISuggestion();
        }

        // Update usage statistics
        function updateStats(tokens, responseTime) {
            requestCount++;
            totalTokens += tokens;
            responseTimes.push(responseTime);

            const avgTime = responseTimes.reduce((a, b) => a + b, 0) / responseTimes.length;

            document.getElementById('requestsCount').textContent = requestCount;
            document.getElementById('tokensUsed').textContent = totalTokens;
            document.getElementById('avgResponseTime').textContent = avgTime.toFixed(1) + 's';
        }

        // Modal management
        function showModal(title, content) {
            document.getElementById('modalContent').innerHTML = content;
            document.getElementById('resultModal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('resultModal').classList.add('hidden');
        }

        // Clipboard functionality
        function copyToClipboard() {
            const content = document.getElementById('aiContent') || document.getElementById('modalContent');
            if (content) {
                navigator.clipboard.writeText(content.textContent || content.innerText);
                alert('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
            }
        }

        // Close modal when clicking outside
        document.getElementById('resultModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelector('.tab-game').classList.add('active', 'bg-yellow-500', 'text-gray-900');
        });
    </script>
</body>

</html>