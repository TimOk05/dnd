# Система авторизации DnD Copilot

## Описание

Добавлена простая система регистрации и входа пользователей для вашего DnD помощника. Система использует файловое хранение данных (без базы данных) для максимальной простоты.

## Файлы системы

- `users.php` - Основной файл управления пользователями
- `login.php` - Страница входа и регистрации
- `users.json` - Файл с данными пользователей (создается автоматически)
- `.htaccess` - Настройки безопасности

## Как использовать

### Для пользователей:

1. **Регистрация:**
   - Перейдите на `login.php`
   - Нажмите вкладку "Регистрация"
   - Введите имя пользователя (3-20 символов, только буквы, цифры и _)
   - Введите пароль (минимум 4 символа)
   - Подтвердите пароль
   - Нажмите "Зарегистрироваться"

2. **Вход:**
   - Перейдите на `login.php`
   - Введите имя пользователя и пароль
   - Нажмите "Войти"

3. **Выход:**
   - На главной странице нажмите кнопку "Выйти" в левом верхнем углу

### Для администратора:

- Все пользователи хранятся в файле `users.json`
- Пароли хешируются с помощью PHP `password_hash()`
- Файл `users.json` защищен от прямого доступа через `.htaccess`

## Безопасность

- Пароли хешируются с использованием `PASSWORD_DEFAULT`
- Валидация входных данных на стороне сервера
- Защита от прямого доступа к файлам пользователей
- Сессии для управления авторизацией

## Настройка

1. Убедитесь, что PHP поддерживает функции `password_hash()` и `password_verify()`
2. Проверьте права на запись в папку для создания файла `users.json`
3. Убедитесь, что Apache поддерживает `.htaccess` файлы

## Миграция со старой системы

Если у вас была старая система с секретным кодом:
1. Старые сессии будут автоматически очищены
2. Пользователям нужно будет зарегистрироваться заново
3. Все данные приложения (заметки, чат) сохранятся

## Возможные улучшения

- Добавление ролей пользователей (админ/обычный пользователь)
- Система восстановления пароля
- Профили пользователей
- Экспорт/импорт данных
- Интеграция с базой данных

## Техническая поддержка

При возникновении проблем:
1. Проверьте права доступа к файлам
2. Убедитесь, что PHP поддерживает JSON
3. Проверьте логи ошибок сервера
4. Убедитесь, что сессии работают корректно
